<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.renren.modules.job.dao.UsersDao">
	<resultMap id="usersMap" type="io.renren.modules.job.entity.UsersEntity">
  		<result property="name" column="user_name"/>
  		<result property="userid" column="user_id"/>
	</resultMap>
	<select id="queryObject" resultMap= "usersMap" resultType="io.renren.modules.job.entity.UsersEntity" >
		select * from zq_user where user_id = #{userid}
	</select> 
	<select id="queryTotal" resultType="int">
		select count(*) from zq_user
			   <where>
             		<if test="status !=null ">
						status = #{status}
               		</if>
        		</where> 
    </select>
     <update id="updateStatus"> 
		update zq_user set status = case when status = 1 then 0 when status = 0 then 1 end
	</update>
	<delete id="deleteStatus">
		delete from zq_user where status = 0 
	</delete>
	<select id="queryAllUsers" resultType="io.renren.modules.job.entity.UsersEntity" >
		select * from zq_user
	</select>
	<select id="queryByTime" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        select * from zq_user 
                <where>
                    <if test="dStart!=null">
                        <![CDATA[  and DATE_FORMAT(#{dEnd}, '%Y-%m-%d %H:%T:%s') >=  
                        DATE_FORMAT(#{dStart}, '%Y-%m-%d %H:%T:%s')   ]]>
                    </if>
                    <if test="dEnd!=null">
                        <![CDATA[  and DATE_FORMAT(created_timestamp, '%Y-%m-%d %H:%T:%s') <= 
                        DATE_FORMAT(#{dEnd} , '%Y-%m-%d %H:%T:%s')    ]]>
                    </if>
                </where>    
                order by created_timestamp desc
    </select>
    
  	<delete id="deleteAll">
		delete from zq_user
	</delete>
	
	<insert id="saveBatch" parameterType="java.util.List">
		insert into zq_user(
			object_id,
			user_name,
			user_id,
			status,
			creator_id,
			created_timestamp,
			last_modifier_id,
			modified_timestamp
			) 
		 
		<foreach item="item" collection="list" index="index" separator="union all" >
			(
			 select
			 #{item.objectId,jdbcType=NUMERIC},
			 #{item.name,jdbcType=VARCHAR},
			 #{item.userid,jdbcType=VARCHAR},
			 #{item.status,jdbcType=NUMERIC},
			 #{item.creatorId,jdbcType=VARCHAR},
			 #{item.createdTimestamp,jdbcType=TIMESTAMP},
			 #{item.lastModifierId,jdbcType=VARCHAR},
			 #{item.modifiedTimestamp,jdbcType=TIMESTAMP}
			 from dual
			 )
		</foreach>
	</insert>
	<insert id="save" parameterType="io.renren.modules.job.entity.UsersEntity" >
		insert into zq_user(
			object_id,
			user_name,
			user_id,
			status,
			creator_id,
			created_timestamp,
			last_modifier_id,
			modified_timestamp
			)
		values 
			(
			 #{objectId,jdbcType=NUMERIC},
			 #{name,jdbcType=VARCHAR},
			 #{userid,jdbcType=VARCHAR},
			 #{status,jdbcType=NUMERIC},
			 #{creatorId,jdbcType=VARCHAR},
			 #{createdTimestamp,jdbcType=TIMESTAMP},
			 #{lastModifierId,jdbcType=VARCHAR},
			 #{modifiedTimestamp,jdbcType=TIMESTAMP}
			 )
	</insert>
</mapper>